package woop;

import java.util.LinkedList;

import org.apache.commons.io.output.NullWriter;

import akka.japi.Creator;
import akka.japi.Predicate;

import com.sun.org.apache.bcel.internal.generic.PUSH;

import woop.BiosphereGen.SphereChunk;

public class LruCacheList<T>
{
	public final int TotalItems;

	public LruCacheList(int totalItems)
	{
		this.TotalItems = totalItems;
	}

	private LinkedList<T> _backingList = new LinkedList<T>();

	public synchronized T FindOrAdd(Predicate<T> predicate, Creator<T> creator)
	{
		boolean first = true;

		if (predicate != null)
		{
			for (T item: _backingList)
			{
				if (predicate(item))
				{
					if (!first)
					{
						_backingList.remove(item);
						_backingList.push(item);
					}
					return item;
				}

				first = false;
			}
		}

		T item = null;

		if (creator != null)
		{
			item = creator();
			_backingList.push(item);

			while (_backingList.size() > TotalItems)
			{
				_backingList.removeLast();
			}
		}

		return item;
	}
}
